name: Ubuntu/macOSX Build

on: 
  push:
    paths-ignore:
    - '**/*.md'

jobs:

  Windows-Server-2019:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    - name: install-deps
      run: |
          vcpkg install sdl2:x64-windows sdl2-ttf:x64-windows
          vcpkg integrate install
    - name: build
      run: |
          mkdir build
          cd build
          cmake -DCMAKE_TOOLCHAIN_FILE=C:/vcpkg/scripts/buildsystems/vcpkg.cmake -DBoost_USE_STATIC_LIBS=ON ..
          cmake --build .
    - name: On-Fail
      if: failure()
      run: type build/compile_commands.json
      
    - uses: actions/upload-artifact@v1
      if: endsWith(github.ref, 'github_action')
      with:     
        name: xgs-rws-${{runner.os}}-x64-${{ github.run_id}}
        path: build/Debug/xgs-rws.exe         
        
